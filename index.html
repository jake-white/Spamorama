<html>
<title id = "title">Spamorama!</title>
<div id = "header">
Spamorama
</div>
<link rel="stylesheet" type="text/css" href="style.css">
<div class = "column-left">
<input type = "image" src = "images/button.png" onclick = "send();">
<body onload = "start();">
<table>
	<tr><td>Cash = $<label id = "cash" ></label></tr>
	<tr><td>Spam/second x Gullibility = Cash/second</td></tr>		
	<tr><td>Cash/second = $<label id = "cps"></label>/second</td></tr>
	<tr><td>Spam/second = <label id = "sps"></label> emails/second</td></tr>
	<tr><td>Gullibility = <label id = "g"></label>%</td></tr>
</table>
<br>
<table>
	<tr><td><input type = "button" id = "b0" value = "Manual Labor: $10" onclick = "add(0);"><label id = "l0"></label></td></tr>
	<tr><td>Hire people to manually send out spam messages.</td></tr>
	<tr><td>Spam/second per unit = <label id = "sps0"></label></td></tr>
	<tr><td>Total spam/second of all units = <label id = "total0"></label></td></tr>
	<tr><td><input type = "button" id = "b1" value = "Script Kiddy: $25"onclick = "add(1);"><label id = "l1"></label></td></tr>
	<tr><td>Get some kids to write out scripts for spam bots.</td></tr>
	<tr><td>Spam/second per unit = <label id = "sps1"></label></td></tr>
	<tr><td>Total spam/second of all units = <label id = "total1"></label></td></tr>
</table>
</body>
</div>
<div class = "column-center">
Upgrades:<br>
Cost: $<label id = "upgradecost">?</label><br>
<label id = "description">[Upgrade Description Text]</label>
<table class = "table1">
	<tr>
		<td onmouseover = "hover(0, true);" onmouseout = "hover(0, false)" >
		<button id = "u0" class = "buttonunavailable" onclick = "buy(0)">Social Media Hack</button>
		</td>
		<td onmouseover = "hover(1, true);" onmouseout = "hover(1, false)">		
		<button id = "u1" class = "buttonunavailable" onclick = "buy(1)">Penis Enlargement Pills</button>
		</td>
		<td onmouseover = "hover(2, true);" onmouseout = "hover(2, false)">		
		<button id = "u2" class = "buttonunavailable" onclick = "buy(2)">Audience Targeting</button>
		</td>
		<td onmouseover = "hover(3, true);" onmouseout = "hover(3, false)">		
		<button id = "u3" class = "buttonunavailable" onclick = "buy(3)">Upgrade</button>
		</td>
	</tr>
	<tr>
		<td onmouseover = "hover(4, true);" onmouseout = "hover(4, false)">
		<button id = "u4" class = "buttonunavailable" onclick = "buy(4)">Upgrade</button>
		</td>
		<td onmouseover = "hover(5, true);" onmouseout = "hover(5, false)">		
		<button id = "u5" class = "buttonunavailable" onclick = "buy(5)">Upgrade</button>
		</td>
		<td onmouseover = "hover(6, true);" onmouseout = "hover(6, false)">		
		<button id = "u6" class = "buttonunavailable" onclick = "buy(6)">Upgrade</button>
		</td>
		<td onmouseover = "hover(7, true);" onmouseout = "hover(7, false)">		
		<button id = "u7" class = "buttonunavailable" onclick = "buy(7)">Upgrade</button>
		</td>
	</tr>
	<tr>
		<td onmouseover = "hover(8, true);" onmouseout = "hover(8, false)">
		<button id = "u8" class = "buttonunavailable" onclick = "buy(8)">Upgrade</button>
		</td>
		<td onmouseover = "hover(9, true);" onmouseout = "hover(9, false)">		
		<button id = "u9" class = "buttonunavailable" onclick = "buy(9)">Upgrade</button>
		</td>
		<td onmouseover = "hover(10, true);" onmouseout = "hover(10, false)">		
		<button id = "u10" class = "buttonunavailable" onclick = "buy(10)">Upgrade</button>
		</td>
		<td onmouseover = "hover(11, true);" onmouseout = "hover(11, false)">		
		<button id = "u11" class = "buttonunavailable" onclick = "buy(11)">Upgrade</button>
		</td>
	</tr>
</table>
</div>
<div class = "column-right">
[Right Column]
</div>
<script>
var cash = 0;
var cps = 0, sps = 0, g = 0.5;
var cpsText = document.getElementById('cps'), spsText = document.getElementById('sps'), gText = document.getElementById('g'), cashText = document.getElementById('cash');
var tickTime = 10;
var array = new Array(2); //empty array for numbers of objects
var amounts = [1, 5]; //CPS per object
var costs = [10, 25]; //base cost per object
var names = ["Manual Labor", "Script Kiddy"];
var upgrades = new Array(12);
var upgradecost = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];
var description = [
"You hack into Facenovel, a popular social media site, gaining access to personal information.  This doubles spam/second from Manual Labor.",
"You start sending those kinds of emails.  This increases gullibility by 50%.",
"You gain information on audiences, and are able to send more appropriate emails based on interests.  This increases gullibility by 50%."
];
var modifier = 0.5;
var lastTime;
var start = function()
{
	interval = setInterval(tick, tickTime); //creating a tick interval
	for(var i = 0; i < array.length; ++i)
	{
		array[i] = 0;
	}
	for(var i = 0; i < upgrades.length; ++i)
	{
		upgrades[i] = new Upgrade(i, upgradecost[i]);
		console.log("CREATED UPGRADE " + i);
	}
	window.onfocus = Focus;
	window.onblur = Blur;
}
var tick = function()
{
	calcSPS();
	spam();
	setTexts();
}
var spam = function()
{
	//adding up cash by tickTime, so not a full second. maths needed :o
	cash += cps/(1000/tickTime); //cash per tickTime, incorporating gullibility.
}
var send = function()
{
	cash += g; //every human click gives G amount of dollars (temporary?)
}
var add = function(a)
{	
	if(cash >= costs[a]) //checking for enough cash
	{
		cash-= costs[a];
		array[a] += 1;
		console.log(array[a]);
		console.log("ADDED " + a);
		costs[a] += (modifier * Math.pow(array[a] + 2, a + 2));
		console.log("NOW = " + costs[a]);
	}
}
var calcSPS = function()
{
	sps = 0;
	for(var i = 0; i < array.length; ++i)
	{
		sps += array[i]*amounts[i];
	}
	cps = sps*g;
}
var hover = function(buttonNumber, on)
{
	if(on)
	{
		document.getElementById('upgradecost').innerHTML = upgradecost[buttonNumber];
		document.getElementById('description').innerHTML = description[buttonNumber];
	}
	if(!on)
	{
		document.getElementById('upgradecost').innerHTML = "?"
		document.getElementById('description').innerHTML = "<br>";
	}
}
var buy = function(buttonNumber)
{
	upgrades[buttonNumber].buy();
}
var setTexts = function()
{	
	cpsText.innerHTML = cps;
	spsText.innerHTML = sps;
	gText.innerHTML = g;
	cashText.innerHTML = cash.toFixed(2);
	if(cps > 0)
	document.getElementById('title').innerHTML = cps + "$/second!";
	for(var i = 0; i < array.length; ++i)
	{
		document.getElementById("l"+i).innerHTML = array[i];
		document.getElementById("b"+i).value = names[i] + ": $" + costs[i].toFixed(2);
		document.getElementById("sps"+i).innerHTML = amounts[i];
		document.getElementById("total"+i).innerHTML = amounts[i] * array[i];
	}
	for(var i = 0; i < upgrades.length; ++i)
	{
		var element = document.getElementById("u"+i);
		if(upgrades[i].getBought())
		{
			element.disabled = true;
			element.className = "buttonbought";
		}
		else if(upgrades[i].getAvailable())
		{
			element.disabled = false;
			element.className = "buttonavailable";
		}
		else
		{
			element.disabled = true;
			element.className = "buttonunavailable";
		}
	}
}

//detecting window activity
var Focus = function()
{
	var difference = new Date().getTime() - lastTime;
	cash += cps * (difference/1000);
	interval = setInterval(tick, 10);
}
var Blur = function()
{
	clearInterval(interval);
	lastTime = new Date().getTime();
}

function Upgrade(upgradeNumber, cost)
{
	this.bought = false;
	this.buy = function()
	{
		cash -= cost;
		switch(upgradeNumber)
		{
			case 0:
				amounts[0] *=2; //doubles manual labor amount
				break;
			case 1:
				g *= 1.5;
				break;
			case 2:
				g *= 1.5;
				break;
		}
		this.bought = true;
	}
	this.getBought = function()
	{
		return this.bought;
	}
	this.getAvailable = function()
	{
		if(cash >= cost )
		{
			return true;
		}
		return false;
	}
}
</script>
</html>